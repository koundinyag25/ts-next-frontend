(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5970:(e,l,s)=>{Promise.resolve().then(s.bind(s,7331))},7331:(e,l,s)=>{"use strict";s.r(l),s.d(l,{default:()=>N});var t=s(5155),a=s(2115);let r=s(2651).A.create({baseURL:"https://ts-demo.moolya.xyz"}),c=async e=>{if(!e)return null;console.log(e);try{let l=await r.get("/health");console.log("-----------\x3e",{x:l});let s=await r.post("/search",{prompt:e,limit:10});return console.log("-----------\x3e",s.data),s.data}catch(e){console.log("-----------\x3e",e)}};var n=s(3076),i=s(3310);let d=e=>{let{handleSearch:l,loading:s}=e,[r,c]=(0,a.useState)("");return(0,t.jsx)("div",{className:"flex gap-2 w-full justify-center items-center",children:(0,t.jsxs)("div",{className:"flex w-[70%] gap-2 p-2",children:[(0,t.jsx)(n.A,{placeholder:"Start typing to get CVEs",onChange:e=>c(e.target.value),onKeyDown:e=>{"Enter"===e.key&&l(r)},value:r}),(0,t.jsx)(i.Ay,{onClick:()=>l(r),loading:s,children:"Search"})]})})};var o=s(2093),h=s(4206),x=s(3593),g=s(8854),f=s(6068);let{Text:m}=x.A,u=e=>e>=9?"red":e>=7?"orange":e>=4?"gold":"green",j=e=>{var l,s;let{cve:a}=e;return(0,t.jsxs)("div",{className:"shadow-lg rounded-lg bg-white p-4 m-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center gap-4 overflow-y-auto",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)(m,{className:"text-gray-800",children:a.name}),(0,t.jsxs)(g.A,{color:u(a.severity),className:"text-sm",children:["Severity: ",null!==(s=a.severity)&&void 0!==s?s:"N/A"]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)(m,{className:"block text-gray-600",children:[(0,t.jsx)("strong",{children:"Created:"})," ",new Date(a.api_created).toLocaleDateString()]}),(0,t.jsxs)(m,{className:"block text-gray-600",children:[(0,t.jsx)("strong",{children:"Last Modified:"})," ",new Date(a.api_last_modified).toLocaleDateString()]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)(m,{className:"block text-gray-600",children:[(0,t.jsx)("strong",{children:"EPSS Score:"})," ",null===(l=a.epss_score)||void 0===l?void 0:l.toFixed(5)]}),(0,t.jsxs)(m,{className:"block text-gray-600",children:[(0,t.jsx)("strong",{children:"EPSS Percentile:"})," ",a.epss_percentile?Math.round(100*a.epss_percentile):0,"%"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m,{className:"block text-gray-800 mb-2",children:(0,t.jsx)("strong",{children:"References:"})}),(0,t.jsx)("div",{className:"flex flex-row flex-wrap",children:a.references.length>0?a.references.map((e,l)=>(0,t.jsx)(f.A,{title:null==e?void 0:e.url,children:(0,t.jsxs)("div",{onClick:()=>{console.log(e),window.open(null==e?void 0:e.url,"_blank")},className:"bg-blue-100 p-1 rounded-md m-1 cursor-pointer",children:["ref-",l+1]})},l)):(0,t.jsx)("div",{className:"text-gray-500",children:"No references available"})})]})]})},v=e=>{let{cves:l}=e;return(0,t.jsx)("div",{className:"flex flex-col gap-4 w-[70%] overflow-y-auto h-full bg-gray-100 rounded-lg",children:l.length>0?l.map((e,l)=>(0,t.jsx)(j,{cve:e},l)):(0,t.jsx)("div",{className:"flex justify-center items-center h-[60vh] align-center text-center",children:"Fetch CVEs or search for a different keyword"})})},p=(0,a.memo)(e=>{let{insights:l,cves:s,loading:a}=e;return(0,t.jsxs)("div",{className:"p-4 h-[80vh] w-full gap-4 flex",children:[a?(0,t.jsx)("div",{className:"flex flex-col gap-4 w-[70%] overflow-y-auto h-full bg-gray-100 rounded-lg p-4 gap-4",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4 w-full h-full align-center justify-center",children:[(0,t.jsx)(o.A,{}),(0,t.jsx)("div",{className:"text-center",children:"Please wait while we fetch the data"})]})}):(0,t.jsx)(v,{cves:s}),(0,t.jsxs)("div",{className:"w-[30%] h-full bg-gray-100 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm font-bold p-2 w-full text-center",children:"Insights"}),(0,t.jsx)("div",{className:"flex justify-center items-center flex-col gap-2",children:(0,t.jsx)("div",{className:"flex justify-center items-center h-[70vh] block overflow-y-auto",children:a?(0,t.jsxs)("div",{className:"flex flex-col gap-4 w-full h-full align-center justify-center",children:[(0,t.jsx)(o.A,{}),"Please wait while we fetch the insights"]}):l&&s.length>0?(0,t.jsx)("div",{className:"w-[80%] h-[80%] block overflow-y-auto",children:(0,t.jsx)(h.o,{className:"prose",children:l})}):(0,t.jsx)("div",{className:"flex justify-center items-center h-[60vh] align-center text-center",children:"Fetch data to get insights"})})})]})]})}),N=()=>{let[e,l]=(0,a.useState)([]),[s,r]=(0,a.useState)(""),[n,i]=(0,a.useState)(!1);return(0,t.jsxs)("div",{className:"h-full w-full",children:[(0,t.jsx)("div",{className:"flex p-4 gap-2",children:(0,t.jsx)(d,{handleSearch:e=>{i(!0),c(e).then(e=>{let{data:s,insights:t}=e;l(s.cves),r(t),i(!1)}).catch(e=>{console.error(e),i(!1)}).finally(()=>{i(!1)})},loading:n})}),(0,t.jsx)(p,{insights:s,cves:e,loading:n})]})}}},e=>{var l=l=>e(e.s=l);e.O(0,[880,441,517,358],()=>l(5970)),_N_E=e.O()}]);